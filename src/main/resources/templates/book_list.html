<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Book List</title>
</head>
<body>
<h2>Book List</h2>

<form action="/books/search" method="get">
  <label for="query">Search by Title:</label>
  <input type="text" id="query" name="query" required>
  <button type="submit">Search</button>
</form>

<table border="1">
  <thead>
  <tr>
    <th>Title</th>
    <th>Author</th>
    <th>Price</th>
    <th>Actions</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="book : ${books}">
    <td th:text="${book.title}">Title</td>
    <td th:text="${book.author.name + ' ' + book.author.surname}">Author</td>
    <td th:text="${book.price}">0.00</td>
    <td>
      <a th:href="@{'/books-web/' + ${book.id}}">View</a> |
      <a th:href="@{'/books-web/' + ${book.id} + '/edit'}">Edit</a>
<!--      <button th:attr="data-id=${book.id}" onclick="deleteBook(this)">Delete</button>-->
      <button onclick="deleteBook([[${book.id}]])">Delete</button>
    </td>
  </tr>
  </tbody>
</table>

<a href="/books-web/create">Add New Book</a>

<!--<script>-->
<!--  async function deleteBook(button) {-->
<!--    if (!confirm('Are you sure you want to delete this book?')) return;-->

<!--    const bookId = button.getAttribute("data-id");-->
<!--    try {-->
<!--      const response = await fetch(`/books/${bookId}`, { method: "DELETE" });-->

<!--      if (response.ok) {-->
<!--        alert("Book deleted successfully.");-->
<!--        window.location.reload();-->
<!--      } else {-->
<!--        alert("Failed to delete the book.");-->
<!--      }-->
<!--    } catch (error) {-->
<!--      console.error("Error:", error);-->
<!--      alert("An error occurred while deleting the book.");-->
<!--    }-->
<!--  }-->
<!--</script>-->

</body>
</html>
